{
gROOT->ProcessLine(".L inelastic_style.C ");
  setInelasticStyle(1./3.);
   

  TH1D *model_1 = new TH1D("model_1","Slice 6000-8000 PE in S2",50,0,500);
   model_1->SetBinContent(1,0.0001799856);
   model_1->SetBinContent(4,0.0001799856);
   model_1->SetBinContent(5,0.001079914);
   model_1->SetBinContent(6,0.001259899);
   model_1->SetBinContent(7,0.00287977);
   model_1->SetBinContent(8,0.003959683);
   model_1->SetBinContent(9,0.0199784);
   model_1->SetBinContent(10,0.05939525);
   model_1->SetBinContent(11,0.1445284);
   model_1->SetBinContent(12,0.2242621);
   model_1->SetBinContent(13,0.2145428);
   model_1->SetBinContent(14,0.1654068);
   model_1->SetBinContent(15,0.0912527);
   model_1->SetBinContent(16,0.04013679);
   model_1->SetBinContent(17,0.01529878);
   model_1->SetBinContent(18,0.006479482);
   model_1->SetBinContent(19,0.003779698);
   model_1->SetBinContent(20,0.001979842);
   model_1->SetBinContent(21,0.000899928);
   model_1->SetBinContent(22,0.0007199424);
   model_1->SetBinContent(23,0.0005399568);
   model_1->SetBinContent(24,0.0001799856);
   model_1->SetBinContent(25,0.0003599712);
   model_1->SetBinContent(26,0.0001799856);
   model_1->SetBinContent(33,0.0001799856);
   model_1->SetBinContent(37,0.0001799856);
   model_1->SetBinContent(40,0.0001799856);
   model_1->SetBinError(1,0.0001799856);
   model_1->SetBinError(4,0.0001799856);
   model_1->SetBinError(5,0.0004408729);
   model_1->SetBinError(6,0.0004761971);
   model_1->SetBinError(7,0.0007199424);
   model_1->SetBinError(8,0.0008442073);
   model_1->SetBinError(9,0.001896266);
   model_1->SetBinError(10,0.003269601);
   model_1->SetBinError(11,0.005100298);
   model_1->SetBinError(12,0.006353262);
   model_1->SetBinError(13,0.006214066);
   model_1->SetBinError(14,0.005456266);
   model_1->SetBinError(15,0.004052675);
   model_1->SetBinError(16,0.002687758);
   model_1->SetBinError(17,0.001659385);
   model_1->SetBinError(18,0.001079914);
   model_1->SetBinError(19,0.0008247976);
   model_1->SetBinError(20,0.0005969447);
   model_1->SetBinError(21,0.00040246);
   model_1->SetBinError(22,0.0003599712);
   model_1->SetBinError(23,0.0003117442);
   model_1->SetBinError(24,0.0001799856);
   model_1->SetBinError(25,0.0002545381);
   model_1->SetBinError(26,0.0001799856);
   model_1->SetBinError(33,0.0001799856);
   model_1->SetBinError(37,0.0001799856);
   model_1->SetBinError(40,0.0001799856);
   model_1->SetEntries(5556);

   
   TH1D *data_1 = new TH1D("data_1","Combined 40keV gamma and nuclear recoil",50,0,500);
   data_1->SetBinContent(7,0.0004640573);
   data_1->SetBinContent(8,0.003204995);
   data_1->SetBinContent(9,0.01963673);
   data_1->SetBinContent(10,0.06274658);
   data_1->SetBinContent(11,0.1505279);
   data_1->SetBinContent(12,0.2307766);
   data_1->SetBinContent(13,0.2047676);
   data_1->SetBinContent(14,0.1602479);
   data_1->SetBinContent(15,0.09068104);
   data_1->SetBinContent(16,0.04644299);
   data_1->SetBinContent(17,0.01599793);
   data_1->SetBinContent(18,0.007852921);
   data_1->SetBinContent(19,0.004107734);
   data_1->SetBinContent(20,0.001565837);
   data_1->SetBinContent(21,0.000767766);
   data_1->SetBinContent(22,0.000128192);
   data_1->SetBinContent(23,4.157578e-05);
   data_1->SetBinContent(24,4.157578e-05);
   data_1->SetBinError(7,0.0008641363);
   data_1->SetBinError(8,0.002340092);
   data_1->SetBinError(9,0.005533172);
   data_1->SetBinError(10,0.00992817);
   data_1->SetBinError(11,0.01509149);
   data_1->SetBinError(12,0.01860738);
   data_1->SetBinError(13,0.01891255);
   data_1->SetBinError(14,0.0166967);
   data_1->SetBinError(15,0.01364496);
   data_1->SetBinError(16,0.009712728);
   data_1->SetBinError(17,0.00693107);
   data_1->SetBinError(18,0.004913687);
   data_1->SetBinError(19,0.002993456);
   data_1->SetBinError(20,0.001866748);
   data_1->SetBinError(21,0.001496728);
   data_1->SetBinError(22,0.0007055643);
   data_1->SetBinError(23,0.0004989093);
   data_1->SetBinError(24,0.0004989093);
   data_1->SetEntries(583.3466);
   
   
   TH1D *model_2 = new TH1D("model_2","Slice 8000-10000 PE in S2",50,0,500);
   model_2->SetBinContent(1,0.000119346);
   model_2->SetBinContent(5,0.000238692);
   model_2->SetBinContent(6,0.000119346);
   model_2->SetBinContent(7,0.002148228);
   model_2->SetBinContent(8,0.01002506);
   model_2->SetBinContent(9,0.04642559);
   model_2->SetBinContent(10,0.119704);
   model_2->SetBinContent(11,0.2087361);
   model_2->SetBinContent(12,0.2306958);
   model_2->SetBinContent(13,0.1784222);
   model_2->SetBinContent(14,0.1095596);
   model_2->SetBinContent(15,0.04988662);
   model_2->SetBinContent(16,0.02327247);
   model_2->SetBinContent(17,0.007996181);
   model_2->SetBinContent(18,0.004296455);
   model_2->SetBinContent(19,0.002744958);
   model_2->SetBinContent(20,0.001551498);
   model_2->SetBinContent(21,0.0008354219);
   model_2->SetBinContent(22,0.0008354219);
   model_2->SetBinContent(23,0.0005967299);
   model_2->SetBinContent(24,0.000358038);
   model_2->SetBinContent(25,0.000358038);
   model_2->SetBinContent(26,0.000119346);
   model_2->SetBinContent(27,0.000238692);
   model_2->SetBinContent(29,0.000238692);
   model_2->SetBinContent(31,0.000119346);
   model_2->SetBinContent(33,0.000238692);
   model_2->SetBinContent(37,0.000119346);
   model_2->SetBinContent(51,0.000238692);
   model_2->SetBinError(1,0.000119346);
   model_2->SetBinError(5,0.0001687807);
   model_2->SetBinError(6,0.000119346);
   model_2->SetBinError(7,0.0005063421);
   model_2->SetBinError(8,0.001093824);
   model_2->SetBinError(9,0.002353871);
   model_2->SetBinError(10,0.003779708);
   model_2->SetBinError(11,0.004991174);
   model_2->SetBinError(12,0.005247153);
   model_2->SetBinError(13,0.00461454);
   model_2->SetBinError(14,0.003616006);
   model_2->SetBinError(15,0.002440034);
   model_2->SetBinError(16,0.001666576);
   model_2->SetBinError(17,0.000976889);
   model_2->SetBinError(18,0.0007160759);
   model_2->SetBinError(19,0.0005723632);
   model_2->SetBinError(20,0.0004303081);
   model_2->SetBinError(21,0.0003157598);
   model_2->SetBinError(22,0.0003157598);
   model_2->SetBinError(23,0.0002668657);
   model_2->SetBinError(24,0.0002067133);
   model_2->SetBinError(25,0.0002067133);
   model_2->SetBinError(26,0.000119346);
   model_2->SetBinError(27,0.0001687807);
   model_2->SetBinError(29,0.0001687807);
   model_2->SetBinError(31,0.000119346);
   model_2->SetBinError(33,0.0001687807);
   model_2->SetBinError(37,0.000119346);
   model_2->SetBinError(51,0.0001687807);
   model_2->SetEntries(8379);
   
   TH1D *data_2 = new TH1D("data_2","Combined 40keV gamma and nuclear recoil",50,0,500);
   data_2->SetBinContent(5,0.0002840699);
   data_2->SetBinContent(6,0.0003550874);
   data_2->SetBinContent(7,0.002944938);
   data_2->SetBinContent(8,0.01301834);
   data_2->SetBinContent(9,0.04580507);
   data_2->SetBinContent(10,0.126548);
   data_2->SetBinContent(11,0.2019671);
   data_2->SetBinContent(12,0.2340004);
   data_2->SetBinContent(13,0.1729248);
   data_2->SetBinContent(14,0.1096056);
   data_2->SetBinContent(15,0.05313721);
   data_2->SetBinContent(16,0.02404811);
   data_2->SetBinContent(17,0.007852789);
   data_2->SetBinContent(18,0.003679419);
   data_2->SetBinContent(19,0.00288777);
   data_2->SetBinContent(20,0.0005896846);
   data_2->SetBinContent(21,0.0002596459);
   data_2->SetBinContent(22,9.2017e-05);
   data_2->SetBinError(5,0.0002840699);
   data_2->SetBinError(6,0.0006351997);
   data_2->SetBinError(7,0.001656398);
   data_2->SetBinError(8,0.003479132);
   data_2->SetBinError(9,0.006389995);
   data_2->SetBinError(10,0.01058708);
   data_2->SetBinError(11,0.01369736);
   data_2->SetBinError(12,0.01466472);
   data_2->SetBinError(13,0.01343564);
   data_2->SetBinError(14,0.01068571);
   data_2->SetBinError(15,0.008242924);
   data_2->SetBinError(16,0.005544824);
   data_2->SetBinError(17,0.003736356);
   data_2->SetBinError(18,0.002572363);
   data_2->SetBinError(19,0.001840983);
   data_2->SetBinError(20,0.0008034711);
   data_2->SetBinError(21,0.0006958264);
   data_2->SetBinError(22,0.0004017355);
   data_2->SetEntries(1010.538);
   
   
   TH1D *model_3 = new TH1D("model_3","Slice 10000-12000 PE in S2",50,0,500);
   model_3->SetBinContent(6,0.001303781);
   model_3->SetBinContent(7,0.008257279);
   model_3->SetBinContent(8,0.03042156);
   model_3->SetBinContent(9,0.09973924);
   model_3->SetBinContent(10,0.1818774);
   model_3->SetBinContent(11,0.2346806);
   model_3->SetBinContent(12,0.1849196);
   model_3->SetBinContent(13,0.1234246);
   model_3->SetBinContent(14,0.06410256);
   model_3->SetBinContent(15,0.03085615);
   model_3->SetBinContent(16,0.01586267);
   model_3->SetBinContent(17,0.006953498);
   model_3->SetBinContent(18,0.003259452);
   model_3->SetBinContent(19,0.002607562);
   model_3->SetBinContent(20,0.002172968);
   model_3->SetBinContent(21,0.001521078);
   model_3->SetBinContent(22,0.0004345937);
   model_3->SetBinContent(23,0.0004345937);
   model_3->SetBinContent(24,0.0006518905);
   model_3->SetBinContent(25,0.0008691873);
   model_3->SetBinContent(26,0.0006518905);
   model_3->SetBinContent(27,0.001086484);
   model_3->SetBinContent(28,0.001303781);
   model_3->SetBinContent(29,0.0006518905);
   model_3->SetBinContent(30,0.0004345937);
   model_3->SetBinContent(31,0.0008691873);
   model_3->SetBinContent(32,0.0002172968);
   model_3->SetBinContent(33,0.0004345937);
   model_3->SetBinContent(51,0.0002172968);
   model_3->SetBinError(6,0.0005322664);
   model_3->SetBinError(7,0.001339508);
   model_3->SetBinError(8,0.002571091);
   model_3->SetBinError(9,0.004655429);
   model_3->SetBinError(10,0.006286604);
   model_3->SetBinError(11,0.007141102);
   model_3->SetBinError(12,0.006338962);
   model_3->SetBinError(13,0.005178781);
   model_3->SetBinError(14,0.003732196);
   model_3->SetBinError(15,0.002589391);
   model_3->SetBinError(16,0.001856585);
   model_3->SetBinError(17,0.001229216);
   model_3->SetBinError(18,0.000841587);
   model_3->SetBinError(19,0.0007527383);
   model_3->SetBinError(20,0.0006871529);
   model_3->SetBinError(21,0.0005749134);
   model_3->SetBinError(22,0.0003073041);
   model_3->SetBinError(23,0.0003073041);
   model_3->SetBinError(24,0.0003763691);
   model_3->SetBinError(25,0.0004345937);
   model_3->SetBinError(26,0.0003763691);
   model_3->SetBinError(27,0.0004858905);
   model_3->SetBinError(28,0.0005322664);
   model_3->SetBinError(29,0.0003763691);
   model_3->SetBinError(30,0.0003073041);
   model_3->SetBinError(31,0.0004345937);
   model_3->SetBinError(32,0.0002172968);
   model_3->SetBinError(33,0.0003073041);
   model_3->SetBinError(51,0.0002172968);
   model_3->SetEntries(4602);
   
   TH1D *data_3 = new TH1D("data_3","Combined 40keV gamma and nuclear recoil",50,0,500);
   data_3->SetBinContent(5,0.0006790893);
   data_3->SetBinContent(6,0.004661665);
   data_3->SetBinContent(7,0.01402918);
   data_3->SetBinContent(8,0.0457115);
   data_3->SetBinContent(9,0.1049476);
   data_3->SetBinContent(10,0.1964524);
   data_3->SetBinContent(11,0.21031);
   data_3->SetBinContent(12,0.1862366);
   data_3->SetBinContent(13,0.1171369);
   data_3->SetBinContent(14,0.06817784);
   data_3->SetBinContent(15,0.03052805);
   data_3->SetBinContent(16,0.0135987);
   data_3->SetBinContent(17,0.003245648);
   data_3->SetBinContent(18,0.002055945);
   data_3->SetBinContent(19,0.001684417);
   data_3->SetBinContent(20,0.0004308308);
   data_3->SetBinContent(21,4.118755e-05);
   data_3->SetBinContent(22,7.243619e-05);
   data_3->SetBinError(5,0.0006002358);
   data_3->SetBinError(6,0.001749973);
   data_3->SetBinError(7,0.004004072);
   data_3->SetBinError(8,0.007277472);
   data_3->SetBinError(9,0.0118385);
   data_3->SetBinError(10,0.01622303);
   data_3->SetBinError(11,0.01808693);
   data_3->SetBinError(12,0.01697193);
   data_3->SetBinError(13,0.01404475);
   data_3->SetBinError(14,0.01067846);
   data_3->SetBinError(15,0.007227796);
   data_3->SetBinError(16,0.004839256);
   data_3->SetBinError(17,0.003147663);
   data_3->SetBinError(18,0.002546585);
   data_3->SetBinError(19,0.001697723);
   data_3->SetBinError(20,0.0008488616);
   data_3->SetBinError(21,0.0006002358);
   data_3->SetBinError(22,0.0004244308);
   data_3->SetEntries(667.371);

  TCanvas canv("canv", "First canvas", 1000, 800);
  double Bmargin1 = 0.02;
  double top      = 0.04;
  double Bmargin2 = 0.12;
  double h  =  ( 1. - 2.*Bmargin1 -Bmargin2 -top) / 3. ;


  TPad *pad1 = new TPad("pad1", "The pad 80% of the height",0.0,  Bmargin2 + 2.*h + Bmargin1  , 1.0, 1.0  );
  TPad *pad2 = new TPad("pad2", "The pad 20% of the height",0.0, Bmargin2 + h, 1.0, Bmargin2 + 2.*h + Bmargin1  );
  TPad *pad3 = new TPad("pad3", "The pad 20% of the height",0.0, 0.0, 1.0, Bmargin2 + h );

  pad1->SetTopMargin(top);
  pad1->SetRightMargin(0.04);
  pad1->SetLeftMargin(0.14);
  pad1->SetBottomMargin( Bmargin1 /(1. - Bmargin2 - 2.*h - Bmargin1 ));

  pad2->SetTopMargin(0.);
  pad2->SetRightMargin(0.04);
  pad2->SetLeftMargin(0.14);
  pad2->SetBottomMargin(Bmargin1 / (h+Bmargin1));

  pad3->SetLeftMargin(0.14);
  pad3->SetTopMargin(0.);
  pad3->SetBottomMargin(Bmargin2 / (h+Bmargin2));
  pad3->SetRightMargin(0.04);
  
  pad3->Draw();
  pad2->Draw();
  pad1->Draw();

  pad3->cd();
  

model_1->SetLineColor(866);
model_1->SetLineWidth(3);
model_1->SetTitleFont(132); 
model_1->SetTitleFont(132); 
model_1->GetYaxis()->SetTitleSize(0.05 / (h+Bmargin2));
model_1->GetYaxis()->SetLabelSize(0.05 / (h+Bmargin2));
model_1->GetYaxis()->SetRangeUser(0., 0.28);
model_1->SetTitle(""); 
//model_1->SetTitle("cS2 within 6000-8000 PE"); 
data_1->SetLineColor(603);
data_1->SetMarkerStyle(20);
data_1->SetMarkerSize(1.5);
data_1->SetLineWidth(3);
data_1->SetMarkerColor(603);
model_1->GetXaxis()->SetRangeUser(60,200);
model_1->GetXaxis()->SetLabelSize(0.05 / (h+Bmargin2));
model_1->GetXaxis()->SetLabelOffset(0.03);
model_1->GetXaxis()->SetTickSize(0.05);
model_1->GetXaxis()->SetTitleSize(0.05 / (h+Bmargin2));
model_1->GetYaxis()->SetTitle("Event Density");
model_1->GetXaxis()->SetTitle("cS1  [PE]");
model_1->Draw("hist");
data_1->Draw("esame");
/*   TCanvas canv2("canv2", "First canvas", 1000, 800);
  gPad->SetLeftMargin(0.13);
  gPad->SetTopMargin(0.055);
  gPad->SetBottomMargin(0.12);
  gPad->SetRightMargin(0.04);

  */
pad2->cd();

  model_2->SetLineColor(866);
model_2->SetLineWidth(3);
model_2->SetTitle(""); 
//model_2->SetTitle("cS2 within 8000-10000 PE"); 
model_2->GetYaxis()->SetTitle("Event Density");
model_2->GetYaxis()->SetTitleSize(0.05/(h+Bmargin1));
model_2->GetYaxis()->SetLabelSize(0.05/(h+Bmargin1));
model_2->GetYaxis()->SetRangeUser(0., 0.28);
model_2->SetTitleFont(132); 
model_2->GetXaxis()->SetTickSize(0.05);
model_2->GetXaxis()->SetLabelOffset(1.);
data_2->SetLineColor(603);
data_2->SetMarkerStyle(20);
data_2->SetMarkerSize(1.5);
data_2->SetMarkerColor(603);
data_2->SetLineWidth(3);
model_2->GetXaxis()->SetRangeUser(60,200);
model_2->Draw("hist");
data_2->Draw("esame");
/*
  TCanvas canv3("canv3", "First canvas", 1000, 800);
  gPad->SetLeftMargin(0.13);
  gPad->SetTopMargin(0.055);
  gPad->SetBottomMargin(0.12);
  gPad->SetRightMargin(0.04);
*/

   pad1->cd();

   model_3->SetLineColor(866);
model_3->SetLineWidth(3);
//model_3->SetTitle("cS2 within 10000-12000 PE"); 
model_3->SetTitle(""); 
model_3->GetYaxis()->SetTitle("Event Density");
model_3->GetYaxis()->SetTitleSize(0.05/(h+Bmargin1 + top));
model_3->GetYaxis()->SetLabelSize(0.05/(h+Bmargin1 + top));
model_3->GetYaxis()->SetRangeUser(0.,0.28);
model_3->GetXaxis()->SetLabelOffset(1.);
model_3->GetXaxis()->SetTickSize(0.05);
model_3->SetTitleFont(132); 
data_3->SetLineColor(603);
data_3->SetMarkerStyle(20);
data_3->SetMarkerSize(1.5);
data_3->SetMarkerColor(603);
data_3->SetLineWidth(3);
model_3->GetXaxis()->SetRangeUser(60,200);
model_3->Draw("hist");
data_3->Draw("esame");
   
}
